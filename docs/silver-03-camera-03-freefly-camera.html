<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Freefly Camera · OpenGL[&quot;noël&quot;]</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="Ce type de caméra est utilisé dans les jeux à la première personne (les jeux ou on voit à travers les yeux du héros, comme les FPS). Elle permet de se déplacer dans toutes les directions et de tourner sur soit même (la caméra TrackBall ne permettant que de tourner autour du centre de la scène)."/><meta name="docsearch:language" content="en"/><meta property="og:title" content="Freefly Camera · OpenGL[&quot;noël&quot;]"/><meta property="og:type" content="website"/><meta property="og:url" content="https://celeborn2bealive.github.io/openglnoel/"/><meta property="og:description" content="Ce type de caméra est utilisé dans les jeux à la première personne (les jeux ou on voit à travers les yeux du héros, comme les FPS). Elle permet de se déplacer dans toutes les directions et de tourner sur soit même (la caméra TrackBall ne permettant que de tourner autour du centre de la scène)."/><meta property="og:image" content="https://celeborn2bealive.github.io/openglnoel/img/logo.png"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://celeborn2bealive.github.io/openglnoel/img/logo.png"/><link rel="shortcut icon" href="/openglnoel/img/favicon.png"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/atom-one-dark.min.css"/><link rel="alternate" type="application/atom+xml" href="https://celeborn2bealive.github.io/openglnoel/blog/atom.xml" title="OpenGL[&quot;noël&quot;] Blog ATOM Feed"/><link rel="alternate" type="application/rss+xml" href="https://celeborn2bealive.github.io/openglnoel/blog/feed.xml" title="OpenGL[&quot;noël&quot;] Blog RSS Feed"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML"></script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script><script type="text/javascript" src="/openglnoel/js/code-block-buttons.js"></script><script type="text/javascript" src="/openglnoel/js/disqus.js"></script><script src="https://unpkg.com/vanilla-back-to-top@7.1.14/dist/vanilla-back-to-top.min.js"></script><script>
        document.addEventListener('DOMContentLoaded', function() {
          addBackToTop(
            {"zIndex":100}
          )
        });
        </script><script src="/openglnoel/js/scrollSpy.js"></script><link rel="stylesheet" href="/openglnoel/css/main.css"/><script src="/openglnoel/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/openglnoel/"><img class="logo" src="/openglnoel/img/logo.png" alt="OpenGL[&quot;noël&quot;]"/><h2 class="headerTitleWithLogo">OpenGL[&quot;noël&quot;]</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class=""><a href="/openglnoel/docs/intro-sdk-01-philogl-01-introduction" target="_self">Intro et SDK</a></li><li class=""><a href="/openglnoel/docs/bronze-02-hello-triangle-01-code-de-base" target="_self">Bronze</a></li><li class="siteNavGroupActive"><a href="/openglnoel/docs/silver-01-3d-theorie-01-introduction" target="_self">Silver</a></li><li class=""><a href="/openglnoel/docs/gold-01-intro-sdk-01-introduction" target="_self">Gold</a></li><li class=""><a href="/openglnoel/docs/gltf-viewer-01-intro" target="_self">glTF Viewer Tutorial</a></li><li class=""><a href="/openglnoel/blog/" target="_self">Blog</a></li><li class=""><a href="http://docs.gl" target="_self">OpenGL Documentation</a></li><li class=""><a href="https://www.khronos.org/opengl/wiki/" target="_self">OpenGL Wiki</a></li><li class=""><a href="https://github.com/celeborn2bealive/openglnoel" target="_self">GitHub</a></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><div class="hamburger-menu"><div class="line1"></div><div class="line2"></div><div class="line3"></div></div></div><h2><i>›</i><span>Gestion de la caméra</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle">3D - La théorie</h3><ul class=""><li class="navListItem"><a class="navItem" href="/openglnoel/docs/silver-01-3d-theorie-01-introduction">Introduction</a></li><li class="navListItem"><a class="navItem" href="/openglnoel/docs/silver-01-3d-theorie-02-normal-matrix">La Normal Matrix</a></li><li class="navListItem"><a class="navItem" href="/openglnoel/docs/silver-01-3d-theorie-03-3d-vertex-shader">Un exemple de Vertex Shader pour la 3D</a></li><li class="navListItem"><a class="navItem" href="/openglnoel/docs/silver-01-3d-theorie-04-glm">La bibliothèque glm</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">3D - La pratique</h3><ul class=""><li class="navListItem"><a class="navItem" href="/openglnoel/docs/silver-02-3d-pratique-01-introduction">Introduction</a></li><li class="navListItem"><a class="navItem" href="/openglnoel/docs/silver-02-3d-pratique-02-classe-sphere-cone">Les classes Sphere et Cone</a></li><li class="navListItem"><a class="navItem" href="/openglnoel/docs/silver-02-3d-pratique-03-dessiner-sphere">Dessiner une sphere</a></li><li class="navListItem"><a class="navItem" href="/openglnoel/docs/silver-02-3d-pratique-04-dessiner-lune">Dessiner une lune</a></li><li class="navListItem"><a class="navItem" href="/openglnoel/docs/silver-02-3d-pratique-05-dessiner-terre">Dessiner la terre</a></li><li class="navListItem"><a class="navItem" href="/openglnoel/docs/silver-02-3d-pratique-06-multi-texturing">Multi-texturing</a></li><li class="navListItem"><a class="navItem" href="/openglnoel/docs/silver-02-3d-pratique-07-plusieurs-shaders">Utiliser plusieurs shaders</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Gestion de la caméra</h3><ul class=""><li class="navListItem"><a class="navItem" href="/openglnoel/docs/silver-03-camera-01-introduction">Introduction</a></li><li class="navListItem"><a class="navItem" href="/openglnoel/docs/silver-03-camera-02-trackball-camera">Trackball Camera</a></li><li class="navListItem navListItemActive"><a class="navItem" href="/openglnoel/docs/silver-03-camera-03-freefly-camera">Freefly Camera</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Put the lights on !</h3><ul class=""><li class="navListItem"><a class="navItem" href="/openglnoel/docs/silver-04-lighting-01-introduction">Introduction</a></li><li class="navListItem"><a class="navItem" href="/openglnoel/docs/silver-04-lighting-02-directional-light">Directional Light</a></li><li class="navListItem"><a class="navItem" href="/openglnoel/docs/silver-04-lighting-03-point-light">Point Light</a></li><li class="navListItem"><a class="navItem" href="/openglnoel/docs/silver-04-lighting-04-aller-plus-loin">Aller plus loin</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Projet(s)</h3><ul class=""><li class="navListItem"><a class="navItem" href="/openglnoel/docs/silver-05-projets-01-iminecraft">Projet: IM(A)ineCraft</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              var headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                var el = event.target;
                while(el !== headings){
                  if (el.tagName === 'A') {
                    document.body.classList.remove('tocActive');
                    break;
                  } else{
                    el = el.parentNode;
                  }
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><h1 id="__docusaurus" class="postHeaderTitle">Freefly Camera</h1></header><article><div><span><p>Ce type de caméra est utilisé dans les jeux à la première personne (les jeux ou on voit à travers les yeux du héros, comme les FPS). Elle permet de se déplacer dans toutes les directions et de tourner sur soit même (la caméra TrackBall ne permettant que de tourner autour du centre de la scène).</p>
<p>Sa ViewMatrix peut être calculé par un simple appel à la fonction <strong>glm::lookAt(eye, point, up)</strong>. Le premier argument est simplement la position de la caméra exprimée dans le monde. Le deuxième argument est un point que la caméra regarde. Le dernier argument est l'axe vertical de la caméra.</p>
<p>Les arguments <strong>point</strong> et <strong>up</strong> doivent être calculés en passant par les coordonnées sphériques, illustrées ci dessous.</p>
<p><img src="/openglnoel/img/spherical_coordinates.png" alt="Spherical coordinates"></p>
<p>Les coordonnées sphériques \((\phi, \theta)\) sont les angles qui définissent le vecteur \(\vec{F}\)  (qu'on appelera le &quot;front vector&quot;) pointant en face de la caméra. On veut pouvoir controller ces angles en utilisant la souris. Notre objectif est de calculer les arguments point et up simplement à partir de la position P de la caméra (argument eye) et des angles \((\phi, \theta)\). Ces trois données seront stockées dans notre classe.</p>
<p>Le point de vue V (argument point) s'obtient simplement en additionnant le vecteur \(\vec{F}\)  à la position: \(V=P+\vec{F})\) .</p>
<p>Il faut donc pouvoir calculer les coordonnées du vecteur \(\vec{F}\)  en fonction de ses coordonnées sphériques \((\phi, \theta)\):</p>
<p>$$
\vec{F} = (\cos(\theta)\sin(\phi), \sin(\theta), \cos(\theta)\cos(\phi))
$$</p>
<p>(attention ici les angles sont exprimées en radians).</p>
<p>Il ne reste que le vecteur vertical \vec{U}  (pour &quot;up&quot;) à calculer. Pour cela nous allons utiliser le vecteur \(\vec{L}\)  (pour &quot;left&quot;) pointant à gauche car il nous resservira par la suite pour faire bouger la caméra latéralement. On a la relation suivante pour \(\vec{L}\) :</p>
<p>$$
\vec{L} =(\sin(\phi+\frac{\pi}{2}), 0, \cos(\phi+\frac{\pi}{2}))
$$</p>
<p>Et pour \(\vec{U}\) :</p>
<p>$$
\vec{U} =\vec{F} \times \vec{L}
$$</p>
<p>où \(\times\) est le produit vectoriel entre les deux vecteur (calculable avec la fonction <strong>glm::cross(F, L)</strong>).</p>
<p>C'est tout pour la théorie, passons à la pratique:</p>
<p><span class="badge todo"></span>  Créez la classe <strong>FreeflyCamera</strong> dans un nouveau fichier <strong>FreeflyCamera.hpp</strong> de la lib glimac. Elle doit contenir les variables membre <strong>glm::vec3 m_Position</strong> représentant la position de la caméra, <strong>float m_fPhi</strong> et <strong>float m_fTheta</strong> représentant les coordonnées sphériques du vecteur \(\vec{F}\) . Ajoutez également les variables <strong>glm::vec3 m_FrontVector</strong>, <strong>glm::vec3 m_LeftVector</strong> et <strong>glm::vec3 m_UpVector</strong> qui contiendront les vecteurs \(\vec{F}\) , \(\vec{L}\)  et \(\vec{U}\)  (ces variables sont redondantes puisqu'elles peuvent être calculés à partir des coordonnées sphériques, mais elles nous permettront de faire moins de calcul à chaque tour de boucle).</p>
<p><span class="badge todo"></span>  Écrivez la méthode privée computeDirectionVectors() qui calcule les vecteurs <strong>m_FrontVector</strong>, <strong>m_LeftVector</strong> et <strong>m_UpVector</strong> à partir des coordonnées sphériques <strong>m_fPhi</strong> et <strong>m_fTheta</strong>. Pour cela il suffit d'appliquer les formules données plus haut.</p>
<p><span class="badge todo"></span>  Écrivez le constructeur. La position de la caméra doit être initialisée à \((0,0,0)\). <strong>m_fPhi</strong> doit être initialisé à \(\pi\) (de cette manière le vecteur \(\vec{F}\)  vaudra \((0,0,−1)\) et on regarde ainsi vers l'axe négatif des \(z\), convention en OpenGL). <strong>m_fTheta</strong> doit être initialisé à 0. Dans le corps du constructeur appelez votre méthode computeDirectionVectors afin que les vecteurs directionnels soit correctement initialisés également.</p>
<p><span class="badge todo"></span>  Écrivez les méthodes <strong>moveLeft(float t)</strong> et <strong>moveFront(float t)</strong>. Ces méthodes doivent déplacer la position de la caméra respectivement le long du vecteur \vec{L}  et \(\vec{F}\) . (déplacer un point P le long d'un vecteur V correspond à faire <strong>P += t*V</strong>).</p>
<p><span class="badge todo"></span>  Écrivez les méthodes rotateLeft(float degrees) et rotateUp(float degrees) modifiant les angles de rotations <strong>m_fPhi</strong> et <strong>m_fTheta</strong> (attention à convertir degrees en radians avant de faire l'addition avec les angles courants).</p>
<p><span class="badge todo"></span>  Écrivez la méthodes <strong>glm::mat4 getViewMatrix()</strong> const qui calcule et renvoi la matrice View associée à la caméra. Comme je l'ai dis plus haut, il suffit d'appeler <strong>glm::lookAt</strong> avec les bon arguments.</p>
<p><span class="badge todo"></span>  Reprenez le code précédent en utilisant cette fois la caméra FreeFly. Comme pour la caméra TrackBall, la caméra doit tourner lorsque la souris bouge alors que le bouton droit est pressé. Le déplacement doit être géré avec les touches Z, Q, S, D (comme dans un vrai FPS). La touche Z permet de bouger en avant, S en arrière, Q à gauche et D à droite.</p>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="/openglnoel/docs/silver-03-camera-02-trackball-camera"><span class="arrow-prev">← </span><span>Trackball Camera</span></a><a class="docs-next button" href="/openglnoel/docs/silver-04-lighting-01-introduction"><span>Introduction</span><span class="arrow-next"> →</span></a></div></div></div><nav class="onPageNav"></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/openglnoel/" class="nav-home"><img src="/openglnoel/img/logo.png" alt="OpenGL[&quot;noël&quot;]" width="66" height="58"/></a><div><h5>About Me</h5><a href="http://laurentnoel.fr">Personal website</a><a href="https://github.com/Celeborn2BeAlive/">Github</a></div><div><h5>About This Website</h5><a href="/openglnoel/blog">Blog</a><a class="github-button" href="https://github.com/celeborn2bealive/openglnoel" data-icon="octicon-star" data-count-href="/celeborn2bealive/openglnoel/stargazers" data-show-count="true" data-count-aria-label="# stargazers on GitHub" aria-label="Star this project on GitHub">openglnoel</a><a href="https://docusaurus.io/">Powered by Docusaurus</a></div><div><h5>About OpenGL</h5><a href="docs.gl">Documentation (docs.gl)</a><a href="https://www.khronos.org/opengl/wiki/">Wiki</a></div></section><section class="copyright">Copyright © 2020 Laurent NOEL</section></footer></div></body></html>