<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Le code de base · OpenGL[&quot;noël&quot;]</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="&lt;blockquote&gt;
&lt;p&gt;&lt;span class=&quot;badge warning&quot;&gt;&lt;/span&gt; La partie Bronze n&#x27;a pas encore été adaptée au nouveau template disponible sur Github.&lt;/p&gt;
&lt;/blockquote&gt;
"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="Le code de base · OpenGL[&quot;noël&quot;]"/><meta property="og:type" content="website"/><meta property="og:url" content="https://celeborn2bealive.github.io/openglnoel/index.html"/><meta property="og:description" content="&lt;blockquote&gt;
&lt;p&gt;&lt;span class=&quot;badge warning&quot;&gt;&lt;/span&gt; La partie Bronze n&#x27;a pas encore été adaptée au nouveau template disponible sur Github.&lt;/p&gt;
&lt;/blockquote&gt;
"/><meta property="og:image" content="https://celeborn2bealive.github.io/openglnoel/img/logo.png"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://celeborn2bealive.github.io/openglnoel/img/logo.png"/><link rel="shortcut icon" href="/openglnoel/img/favicon.png"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/atom-one-dark.min.css"/><link rel="alternate" type="application/atom+xml" href="https://celeborn2bealive.github.io/openglnoel/blog/atom.xml" title="OpenGL[&quot;noël&quot;] Blog ATOM Feed"/><link rel="alternate" type="application/rss+xml" href="https://celeborn2bealive.github.io/openglnoel/blog/feed.xml" title="OpenGL[&quot;noël&quot;] Blog RSS Feed"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML"></script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script><script type="text/javascript" src="/openglnoel/js/code-block-buttons.js"></script><script type="text/javascript" src="/openglnoel/js/disqus.js"></script><script src="https://unpkg.com/vanilla-back-to-top@7.1.14/dist/vanilla-back-to-top.min.js"></script><script>
        document.addEventListener('DOMContentLoaded', function() {
          addBackToTop(
            {"zIndex":100}
          )
        });
        </script><link rel="stylesheet" href="/openglnoel/css/main.css"/><script src="/openglnoel/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/openglnoel/"><img class="logo" src="/openglnoel/img/logo.png" alt="OpenGL[&quot;noël&quot;]"/><h2 class="headerTitleWithLogo">OpenGL[&quot;noël&quot;]</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class=""><a href="/openglnoel/docs/intro-sdk-01-philogl-01-introduction" target="_self">Introduction et SDK</a></li><li class="siteNavGroupActive siteNavItemActive"><a href="/openglnoel/docs/bronze-02-hello-triangle-01-code-de-base" target="_self">Bronze</a></li><li class=""><a href="/openglnoel/docs/silver-01-3d-theorie-01-introduction" target="_self">Silver</a></li><li class=""><a href="/openglnoel/docs/gold-01-intro-sdk-01-introduction" target="_self">Gold</a></li><li class=""><a href="/openglnoel/blog/" target="_self">Blog</a></li><li class=""><a href="http://docs.gl" target="_self">OpenGL Documentation</a></li><li class=""><a href="https://www.khronos.org/opengl/wiki/" target="_self">OpenGL Wiki</a></li><li class=""><a href="https://github.com/celeborn2bealive/openglnoel" target="_self">GitHub</a></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="container docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><i></i></div><h2><i>›</i><span>Hello Triangle</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle">Hello Triangle</h3><ul class=""><li class="navListItem navListItemActive"><a class="navItem" href="/openglnoel/docs/bronze-02-hello-triangle-01-code-de-base">Le code de base</a></li><li class="navListItem"><a class="navItem" href="/openglnoel/docs/bronze-02-hello-triangle-02-triangle-blanc">Dessiner un triangle blanc</a></li><li class="navListItem"><a class="navItem" href="/openglnoel/docs/bronze-02-hello-triangle-03-triangle-couleurs">Dessiner un triangle en couleurs</a></li><li class="navListItem"><a class="navItem" href="/openglnoel/docs/bronze-02-hello-triangle-04-vertex-structure">Utiliser une structure de vertex</a></li><li class="navListItem"><a class="navItem" href="/openglnoel/docs/bronze-02-hello-triangle-05-dessiner-quad">Dessiner un quad</a></li><li class="navListItem"><a class="navItem" href="/openglnoel/docs/bronze-02-hello-triangle-06-dessiner-disque">Dessiner un disque</a></li><li class="navListItem"><a class="navItem" href="/openglnoel/docs/bronze-02-hello-triangle-07-index-buffers">Utiliser les buffers d&#x27;index</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Les shaders</h3><ul class=""><li class="navListItem"><a class="navItem" href="/openglnoel/docs/bronze-03-shaders-01-kesako">Shaders, kesako ?</a></li><li class="navListItem"><a class="navItem" href="/openglnoel/docs/bronze-03-shaders-02-exemple">Les shaders par l&#x27;exemple</a></li><li class="navListItem"><a class="navItem" href="/openglnoel/docs/bronze-03-shaders-03-compilation">Charger, compiler et utiliser</a></li><li class="navListItem"><a class="navItem" href="/openglnoel/docs/bronze-03-shaders-04-jouer">Jouer avec les shaders</a></li><li class="navListItem"><a class="navItem" href="/openglnoel/docs/bronze-03-shaders-05-mandelbrot">Mandelbrot</a></li><li class="navListItem"><a class="navItem" href="/openglnoel/docs/bronze-03-shaders-06-la-suite">Préparer la suite</a></li><li class="navListItem"><a class="navItem" href="/openglnoel/docs/bronze-03-shaders-07-triangle-tourne">Un triangle qui tourne</a></li><li class="navListItem"><a class="navItem" href="/openglnoel/docs/bronze-03-shaders-08-matrices">Envoyer des matrices</a></li><li class="navListItem"><a class="navItem" href="/openglnoel/docs/bronze-03-shaders-09-plusieurs-triangles">Plusieur triangles</a></li><li class="navListItem"><a class="navItem" href="/openglnoel/docs/bronze-03-shaders-10-textures">Textures</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              const headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                if (event.target.tagName === 'A') {
                  document.body.classList.remove('tocActive');
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer"><div class="wrapper"><div class="post"><header class="postHeader"><h1 class="postHeaderTitle">Le code de base</h1></header><article><div><span><blockquote>
<p><span class="badge warning"></span> La partie Bronze n'a pas encore été adaptée au nouveau template disponible sur Github.</p>
</blockquote>
<p>Commençons par jeter un oeil au code de base du fichier TP_template/SDLtemplate.cpp. Ce code est en C++, que vous ne connaissez peut-être pas encore. Il faudra vous y faire car vous allez en bouffer !</p>
<pre><code class="hljs css language-cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;glimac/SDLWindowManager.hpp&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;GL/glew.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span>

<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> glimac;

<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">char</span>** argv)</span> </span>{
    <span class="hljs-comment">// Initialize SDL and open a window</span>
    <span class="hljs-function">SDLWindowManager <span class="hljs-title">windowManager</span><span class="hljs-params">(<span class="hljs-number">800</span>, <span class="hljs-number">600</span>, <span class="hljs-string">"GLImac"</span>)</span></span>;

    <span class="hljs-comment">// Initialize glew for OpenGL3+ support</span>
    GLenum glewInitError = glewInit();
    <span class="hljs-keyword">if</span>(GLEW_OK != glewInitError) {
        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; glewGetErrorString(glewInitError) &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;
        <span class="hljs-keyword">return</span> EXIT_FAILURE;
    }

    <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">"OpenGL Version : "</span> &lt;&lt; glGetString(GL_VERSION) &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;
    <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">"GLEW Version : "</span> &lt;&lt; glewGetString(GLEW_VERSION) &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;

    <span class="hljs-comment">/*********************************
     * HERE SHOULD COME THE INITIALIZATION CODE
     *********************************/</span>

    <span class="hljs-comment">// Application loop:</span>
    <span class="hljs-keyword">bool</span> done = <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">while</span>(!done) {
        <span class="hljs-comment">// Event loop:</span>
        SDL_Event e;
        <span class="hljs-keyword">while</span>(windowManager.pollEvent(e)) {
            <span class="hljs-keyword">if</span>(e.type == SDL_QUIT) {
                done = <span class="hljs-literal">true</span>; <span class="hljs-comment">// Leave the loop after this iteration</span>
            }
        }

        <span class="hljs-comment">/*********************************
         * HERE SHOULD COME THE RENDERING CODE
         *********************************/</span>

        <span class="hljs-comment">// Update the display</span>
        windowManager.swapBuffers();
    }

    <span class="hljs-keyword">return</span> EXIT_SUCCESS;
}
</code></pre>
<p>Comme vous pouvez le constater le code est assez court. La classe SDLWindowManager se charge de gérer ce qui concerne la SDL: ouverture de fenêtre, récupération d'évenements clavier-souris. Ainsi la ligne:</p>
<pre><code class="hljs css language-cpp"><span class="hljs-function">SDLWindowManager <span class="hljs-title">windowManager</span><span class="hljs-params">(<span class="hljs-number">800</span>, <span class="hljs-number">600</span>, <span class="hljs-string">"GLImac"</span>)</span></span>;
</code></pre>
<p>va ouvrir une fenêtre de résolution 800x600 dont le titre est &quot;GLImac&quot;. La variable windowManager sera utilisée par la suite pour gérer les évenements.</p>
<p>La portion de code suivante:</p>
<pre><code class="hljs css language-cpp">GLenum glewInitError = glewInit();
<span class="hljs-keyword">if</span>(GLEW_OK != glewInitError) {
    <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; glewGetErrorString(glewInitError) &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;
    <span class="hljs-keyword">return</span> EXIT_FAILURE;
}
</code></pre>
<p>initialise la bibliothèque GLEW. Cette bibliothèque charge l'ensemble des fonctions OpenGL3. Sans elle on peut considerer que l'on a accès qu'aux fonctions OpenGL2.</p>
<p>On affiche ensuite des informations sur OpenGL afin de vérifier que l'on a la bonne version:</p>
<pre><code class="hljs css language-cpp"><span class="hljs-built_in">std</span>::<span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">"OpenGL Version : "</span> &lt;&lt; glGetString(GL_VERSION) &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;
<span class="hljs-built_in">std</span>::<span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">"GLEW Version : "</span> &lt;&lt; glewGetString(GLEW_VERSION) &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;
</code></pre>
<p>Pour les TPs, vous devrez placer le code d'initialisation à cet endroit:</p>
<pre><code class="hljs css language-cpp"><span class="hljs-comment">/*********************************
 * HERE SHOULD COME THE INITIALIZATION CODE
 *********************************/</span>
</code></pre>
<p>Ensuite vient le code de la boucle d'application.</p>
<pre><code class="hljs css language-cpp"><span class="hljs-keyword">bool</span> done = <span class="hljs-literal">false</span>;
<span class="hljs-keyword">while</span>(!done) {
</code></pre>
<p>Cette boucle s'executera tant que la variable done vaut false.</p>
<p>Au sein de la boucle d'application, on trouve la boucle de traitement d'évenements:</p>
<pre><code class="hljs css language-cpp">SDL_Event e;
<span class="hljs-keyword">while</span>(windowManager.pollEvent(e)) {
    <span class="hljs-keyword">if</span>(e.type == SDL_QUIT) {
        done = <span class="hljs-literal">true</span>; <span class="hljs-comment">// Leave the loop after this iteration</span>
    }
}
</code></pre>
<p>Lorsqu'on évenement survient (clic souris, touche clavier, déplacement souris, etc.), la SDL l'enregistre dans une pile appelée pile d'évenement. La methode windowManager.pollEvent(e) permet de dépiler le dernier évenement reçu afin de le traiter dans la boucle. Tant qu'il reste des évenements, la méthode renvoit true et la boucle se relance.
Actuellement le seul évenement traité est SDL_QUIT, qui est déclenché lorsque l'utilisateur ferme la fenêtre. Dans ce cas on fixe done à true, ce qui aura pour effet de quitter la boucle d'application et terminer le programme. Par la suite vous aurez à rajouter d'autres traitement d'évenements dans cette boucle.</p>
<p>Le code de rendu 2D/3D que vous aurez à écrire viendra après la boucle d'évenement, à la place de :</p>
<pre><code class="hljs css language-cpp"><span class="hljs-comment">/*********************************
* HERE SHOULD COME THE RENDERING CODE
*********************************/</span>
</code></pre>
<p>Enfin, l'appel à la méthode windowManager.swapBuffers(); met à jour l'affichage de la fenêtre en pratiquant le double buffering (que vous verrez en cours).</p>
<p>Ce code est la base de toute application multimédia interactive. Il est donc important de bien comprendre sa structure.</p>
</span></div></article></div><div class="docs-prevnext"><a class="docs-next button" href="/openglnoel/docs/bronze-02-hello-triangle-02-triangle-blanc"><span>Dessiner un triangle blanc</span><span class="arrow-next"> →</span></a></div></div></div><nav class="onPageNav"></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/openglnoel/" class="nav-home"><img src="/openglnoel/img/logo.png" alt="OpenGL[&quot;noël&quot;]" width="66" height="58"/></a><div><h5>About Me</h5><a href="http://laurentnoel.fr">Personal website</a><a href="https://github.com/Celeborn2BeAlive/">Github</a></div><div><h5>About This Website</h5><a href="/openglnoel/blog">Blog</a><a class="github-button" href="https://github.com/celeborn2bealive/openglnoel" data-icon="octicon-star" data-count-href="/celeborn2bealive/openglnoel/stargazers" data-show-count="true" data-count-aria-label="# stargazers on GitHub" aria-label="Star this project on GitHub">openglnoel</a><a href="https://docusaurus.io/">Powered by Docusaurus</a></div><div><h5>About OpenGL</h5><a href="docs.gl">Documentation (docs.gl)</a><a href="https://www.khronos.org/opengl/wiki/">Wiki</a></div></section><section class="copyright">Copyright © 2019 Laurent NOEL</section></footer></div></body></html>